# AstrBot LLMPerception 插件

## 简介

LLMPerception 是一个为 AstrBot 设计的插件，旨在增强 LLM 对用户环境的感知能力，让 AI 能够更好地理解用户所处的时间、节假日和平台环境，从而提供更贴心、更符合场景的回复。

最近更新：修复节假日名称返回 None 时造成字符串拼接失败的问题，提升感知信息的稳定性。

## 功能特性

### 🕒 时间感知
- 精确的时间戳（年-月-日 时:分:秒）
- 可自定义时区设置
- 时间段识别（上午/中午/下午/晚上/深夜）

### 🎉 节假日感知
- **法定节假日识别**：自动识别春节、清明节、劳动节、端午节、中秋节、国庆节、元旦等
- **调休识别**：自动判断调休工作日（如国庆期间周末需要上班）
- **星期识别**：周一到周日、工作日/周末判断
- 基于 `chinese-calendar` 库，数据准确可靠

### 🌐 平台环境感知
- **平台类型**：自动识别 QQ、Telegram、Discord、微信公众号、企业微信等
- **聊天类型**：区分群聊和私聊
- **群聊名称**：支持读取群昵称，缺失时自动调协议端补全
- **消息类型**：识别是否包含图片、语音、视频

## 配置说明

插件提供以下可配置项（通过 AstrBot 控制台或配置文件修改）：

| 配置项 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| `timezone` | str | `Asia/Shanghai` | 时区设置，如 `Asia/Tokyo`, `America/New_York`, `UTC` 等 |
| `enable_holiday_perception` | bool | `true` | 启用/禁用节假日感知 |
| `enable_platform_perception` | bool | `true` | 启用/禁用平台环境感知 |
| `holiday_country` | str | `CN` | 节假日国家/地区代码（目前仅支持 CN） |

## 效果示例

启用所有功能后，LLM 收到的消息格式如下：

```
[发送时间: 2025-10-17 14:30:00 | 周五, 工作日, 下午 | 平台: QQ, 群聊, 含图片]
用户的实际消息内容
```

春节期间：
```
[发送时间: 2025-02-01 10:00:00 | 周六, 法定节假日, 春节, 上午 | 平台: Telegram, 私聊]
新年快乐！
```

调休工作日：
```
[发送时间: 2025-02-08 09:00:00 | 周六, 调休工作日, 上午 | 平台: QQ, 群聊]
今天要上班吗？
```

## 安装

1. 在 AstrBot 插件市场搜索 `LLMPerception` 并安装
2. 或手动克隆到 `data/plugins/` 目录
3. 插件会自动安装依赖 `chinese-calendar`

## 依赖

- `chinese-calendar>=1.9.0`：用于准确的中国节假日和调休识别

## 使用建议

### AI 可以利用这些信息做什么？

1. **时间相关**
   - 深夜时关心用户休息：「这么晚还没休息呀」
   - 早上时问候：「早上好！」
   - 根据时间段调整回复风格

2. **节假日相关**
   - 节日送上祝福：「春节快乐！」
   - 周末时更轻松随意的语气
   - 调休工作日时表示理解：「周末还要上班辛苦了」

3. **平台环境相关**
   - 群聊时更活跃，私聊时更贴心
   - 根据平台特性调整回复（如 Telegram 支持更多格式）
   - 识别到图片时可以主动询问或评论

## 开发者

- 作者：喵喵
- 仓库：[GitHub](https://github.com/miaoxutao123/astrbot_plugin_LLMPerception)

## 支持

- [AstrBot 文档](https://astrbot.app)
- [问题反馈](https://github.com/miaoxutao123/astrbot_plugin_LLMPerception/issues)

## 许可证

本插件遵循 MIT 许可证开源。

